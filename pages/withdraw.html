<div style="animation: fadeIn 0.4s ease-out;">
    <h3 style="text-align: center; color: #2d3436;">विड्रॉ सिस्टम</h3>
    <div style="background: white; padding: 20px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
        
        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
            <button onclick="switchMethod('UPI')" id="tab-upi" style="flex:1; padding: 12px; border-radius: 10px; border: 2px solid #00b894; background: #e6fffb; color: #00b894; font-weight: bold;">UPI</button>
            <button onclick="switchMethod('BANK')" id="tab-bank" style="flex:1; padding: 12px; border-radius: 10px; border: 2px solid #eee; background: white; color: #888; font-weight: bold;">BANK</button>
        </div>

        <div id="payment-inputs">
            <div id="upi-section"><input type="text" id="upi-id" placeholder="UPI ID लिखें" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:10px;"></div>
            <div id="bank-section" style="display:none;">
                <input type="number" id="bank-acc" placeholder="अकाउंट नंबर" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;">
                <input type="text" id="bank-ifsc" placeholder="IFSC कोड" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;">
                <input type="text" id="bank-name" placeholder="नाम" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:10px;">
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
            <button id="btn-50" onclick="processWithdraw(50)" style="background:#00b894; color:white; border:none; padding:12px; border-radius:10px;">₹50</button>
            <button id="btn-100" onclick="processWithdraw(100)" style="background:#00b894; color:white; border:none; padding:12px; border-radius:10px;">₹100</button>
            <button onclick="processWithdraw(200)" style="background:#0984e3; color:white; border:none; padding:12px; border-radius:10px;">₹200</button>
            <button onclick="processWithdraw(500)" style="background:#6c5ce7; color:white; border:none; padding:12px; border-radius:10px;">₹500</button>
        </div>
    </div>
    <div id="history-list" style="margin-top:20px; background:white; border-radius:15px; padding:10px;"></div>
</div>

<script>
    var currentMethod = "UPI";
    function switchMethod(m) {
        currentMethod = m;
        document.getElementById('upi-section').style.display = m === 'UPI' ? 'block' : 'none';
        document.getElementById('bank-section').style.display = m === 'BANK' ? 'block' : 'none';
        document.getElementById('tab-upi').style.borderColor = m === 'UPI' ? '#00b894' : '#eee';
        document.getElementById('tab-bank').style.borderColor = m === 'BANK' ? '#00b894' : '#eee';
    }

    function processWithdraw(amt) {
        let bal = parseFloat(localStorage.getItem('userBalance')) || 0;
        if(bal < amt) return alert("बैलेंस कम है!");
        
        let detail = currentMethod === 'UPI' ? document.getElementById('upi-id').value : document.getElementById('bank-acc').value;
        if(!detail) return alert("विवरण भरें!");

        bal -= amt;
        localStorage.setItem('userBalance', bal);
        window.parent.balance = bal;
        window.parent.updateUI();

        let history = JSON.parse(localStorage.getItem('withdrawHistory')) || [];
        history.unshift({amt, method: currentMethod, status: 'Pending', time: new Date().toLocaleString()});
        localStorage.setItem('withdrawHistory', JSON.stringify(history));

        if(amt <= 100) document.getElementById('btn-'+amt).style.display = 'none';
        alert("विड्रॉ सफल!");
        renderHistory();
    }

    function renderHistory() {
        let history = JSON.parse(localStorage.getItem('withdrawHistory')) || [];
        document.getElementById('history-list').innerHTML = history.map(h => `
            <div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #eee;">
                <span>₹${h.amt} (${h.method})</span><span style="color:orange">${h.status}</span>
            </div>`).join('');
    }
    renderHistory();
</script>
